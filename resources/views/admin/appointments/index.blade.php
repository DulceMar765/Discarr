{{-- resources/views/admin/appointments/index.blade.php --}}\n\n<div class=\"admin-section\">\n    <h2 class=\"mb-4\"><i class=\"bi bi-calendar-check me-2\"></i> Gestión de Reservaciones</h2>\n\n    @if (session('success'))\n        <div class=\"alert alert-success alert-dismissible fade show\" role=\"alert\">\n            {{ session('success') }}\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\" aria-label=\"Close\"></button>\n        </div>\n    @endif\n\n    <div class=\"d-flex justify-content-between align-items-center mb-4\">\n        <div>\n            <a href="#" onclick="loadAdminSection('/admin/appointments/availability'); return false;" class="btn btn-outline-primary me-2">\n                <i class=\"bi bi-calendar-week\"></i> Gestionar Disponibilidad\n            </a>\n        </div>\n    </div>\n\n    <div class=\"card shadow-sm\">\n        <div class=\"card-body\">\n            <div class=\"table-responsive\">\n                <table class=\"table table-hover table-striped\">\n                    <thead class=\"table-light\">\n                        <tr>\n                            <th>ID</th>\n                            <th>Usuario</th>\n                            <th>Fecha</th>\n                            <th>Hora</th>\n                            <th>Descripción</th>\n                            <th>Estado</th>\n                            <th>Acciones</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        @forelse ($appointments as $appointment)\n                            <tr>\n                                <td>{{ $appointment->id }}</td>\n                                <td>{{ $appointment->user->name ?? $appointment->requester_name }}</td>\n                                <td>{{ $appointment->calendarDay->date }}</td>\n                                <td>{{ $appointment->time_slot }}</td>\n                                <td>{{ Str::limit($appointment->description, 30) }}</td>\n                                <td>\n                                    <span class=\"badge {{ $appointment->status == 'confirmed' ? 'bg-success' : ($appointment->status == 'pending' ? 'bg-warning' : 'bg-danger') }}\">\n                                        {{ ucfirst($appointment->status) }}\n                                    </span>\n                                </td>\n                                <td>\n                                    <div class=\"btn-group\">\n                                        <a href="#" onclick="loadAdminSection('/admin/appointments/' + {{ $appointment->id }} + '/edit'); return false;" class="btn btn-sm btn-primary">\n                                            <i class="bi bi-pencil"></i>\n                                        </a>\n                                        <button type=\"button\" class=\"btn btn-sm btn-danger\" onclick=\"deleteAppointment({{ $appointment->id }})\">\n                                            <i class=\"bi bi-trash\"></i>\n                                        </button>\n                                    </div>\n                                </td>\n                            </tr>\n                        @empty\n                            <tr>\n                                <td colspan=\"7\" class=\"text-center\">No hay reservaciones registradas.</td>\n                            </tr>\n                        @endforelse\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n</div>\n\n<script>\n    function deleteAppointment(id) {\n        if (confirm('¿Estás seguro de eliminar esta reservación?')) {\n            fetch(`/admin/appointments/${id}`, {\n                method: 'DELETE',\n                headers: {\n                    'X-CSRF-TOKEN': document.querySelector('meta[name=\"csrf-token\"]').getAttribute('content'),\n                    'Content-Type': 'application/json',\n                    'Accept': 'application/json',\n                    'X-Requested-With': 'XMLHttpRequest'\n                }\n            })\n            .then(response => response.json())\n            .then(data => {\n                if (data.success) {\n                    loadAdminSection('/admin/appointments');\n                } else {\n                    alert('Error al eliminar la reservación');\n                }\n            })\n            .catch(error => {\n                console.error('Error:', error);\n                alert('Error al procesar la solicitud');\n            });\n        }\n    }\n</script>
